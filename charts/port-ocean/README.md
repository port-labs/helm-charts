# Port Ocean

Port Ocean chart allow you to deploy Port intergations that were developed with [Port Ocean Framewok](https://github.com/port-labs/port-ocean.git) .

## Introduction

This chart installs any Port ocean integration and it's dependencies.

## Usage

[Helm](https://helm.sh) must be installed to use the charts. Please refer to
Helm's [documentation](https://helm.sh/docs) to get started.

Once Helm has been set up correctly, add the repo as follows:

```bash showLineNumbers
helm repo add port-labs https://port-labs.github.io/helm-charts
```

If you had already added this repo earlier, run `helm repo update` to retrieve
the latest versions of the packages. You can then run `helm search repo
port-labs` to see the charts.

Use your `PORT_CLIENT_ID` & `PORT_CLIENT_SECRET` to install the chart, with the following command:

```bash showLineNumbers
helm upgrade --install my-ocean-integration port-labs/port-ocean \
  --create-namespace --namespace port-ocean \
  --set integration.secrets.<sensitiveConfigKeyName>="INTEGRATION_SECRET" \
  --set integration.config.<notSensitiveConfigKeyName>="RAW_STRING" \
  --set integration.identifier="my-integration-identifier" \
  --set eventListener.type="KAFKA" \
  --set integration.type="integration type (i.e pagerduty, gitlab)" \
  --set port.clientId="PORT_CLIENT_ID" \
  --set port.clientSecret="PORT_CLIENT_SECRET"
```

To uninstall the chart use:

    helm uninstall my-ocean-integration --namespace port-ocean

The command removes all the Kubernetes components associated with the chart and deletes the release.

## Architecture Overview

The Port Ocean chart supports multiple architectures to fit different operational needs:

### 1. **Single Deployment Architecture** (Default)

- **Description**: Runs as a single always-on Deployment (default). Suitable for most use-cases, this keeps an integration pod running continuously, listening for live events and/or processing Port Actions. Can also trigger periodic syncing as needed.
- **Configuration**:
  ```yaml
  workload:
    kind: "Deployment"
  liveEvents:
    worker:
      enabled: false # Live events handled in main deployment
  actionsProcessor:
    enabled: true
    worker:
      enabled: false # Actions handled in main deployment
  ```

### 2. **CronJob-Only Architecture** (Scheduled Resync)

- **Description**: Runs as a scheduled CronJob, suitable for lightweight scenarios focused on periodic data syncing without continuous operation. The integration pod runs on schedule, performs resync, and then terminates (`ONCE` event listener).
- **Configuration**:
  ```yaml
  workload:
    kind: "CronJob"
    cron:
      resyncTimeoutMinutes: 60
  scheduledResyncInterval: "0 */2 * * *"
  ```

### 3. **Separated Deployments Architecture** (Recommended for Production)

- **Description**: Runs the integration, live events worker, and actions processor each as their own always-on Deployment (no CronJob). Use this configuration when you want maximum scalability, dedicated resources for each function, and real-time responsiveness across all integration capabilities.
- **Configuration**:
  ```yaml
  workload:
    kind: "Deployment"
  liveEvents:
    worker:
      enabled: true
  actionsProcessor:
    enabled: true
    worker:
      enabled: true
  ```

### 4. **Hybrid Architecture**

- **CronJob**: Scheduled data polling on a cron schedule
- **Live Events Worker**: Dedicated deployment for real-time webhook events
- **Actions Processor**: Optional dedicated deployment for actions
- **Use Case**: Periodic polling supplemented with real-time event ingestion
- **Configuration**:
  ```yaml
  workload:
    kind: "CronJob"
  scheduledResyncInterval: "0 */6 * * *" # Every 6 hours
  liveEvents:
    worker:
      enabled: true
      replicaCount: 2
  actionsProcessor:
    enabled: true
    worker:
      enabled: true
  ```

## Configuration

The following table lists the configuration parameters of the `port-ocean` chart and default values.

| Parameter                                                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Default                         |
| -------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------- |
| `nameOverride`                                           | Chart name override.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `""`                            |
| `fullnameOverride`                                       | Fully qualified app name override.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `""`                            |
| `metadataNamePrefixOverride`                             | Prefix override for generated resource names (used in CronJob metadata).                                                                                                                                                                                                                                                                                                                                                                                                                           | `""`                            |
| `podLabels`                                              | Labels to be added to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                            |
| `podServiceAccount.create`                               | Whether to create a service account for the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `false`                         |
| `podServiceAccount.annotations`                          | Annotations to be added to the service account.                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                            |
| `extraEnv`                                               | Extra environment variables to be added to all containers.                                                                                                                                                                                                                                                                                                                                                                                                                                         | `[]`                            |
| `extraVolumes`                                           | Extra volumes to be added to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                            |
| `extraVolumeMounts`                                      | Extra volume mounts to be added to the container.                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `[]`                            |
| `extraLabels`                                            | Extra labels to be applied to all resources.                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                            |
| `port.clientId`                                          | Client ID for Port API authentication (irrelevant if secret.create=false).                                                                                                                                                                                                                                                                                                                                                                                                                         |                                 |
| `port.clientSecret`                                      | Client secret for Port API authentication (irrelevant if secret.create=false).                                                                                                                                                                                                                                                                                                                                                                                                                     |                                 |
| `port.baseUrl`                                           | Base URL for the Port API.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `https://api.getport.io`        |
| `port.ingestUrl`                                         | Ingest URL for Port API (used for data ingestion).                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `https://ingest.getport.io`     |
| `initializePortResources`                                | When set to true, creates a default JQ mapping and the relevant blueprints                                                                                                                                                                                                                                                                                                                                                                                                                         | `true`                          |
| `scheduledResyncInterval`                                | The number in minutes to reschedule and poll data from the 3rd party system (for Deployment). For CronJob, use a cron expression string (e.g., `"0 */1 * * *"` for hourly)                                                                                                                                                                                                                                                                                                                         | `null`                          |
| `scheduleConcurrencyPolicy`                              | The K8s CronJob Scheduling concurrency policy string                                                                                                                                                                                                                                                                                                                                                                                                                                               | `Replace`                       |
| `allowEnvironmentVariablesJqAccess`                      | When set to true, The jq mapping will be able to include environment variables.                                                                                                                                                                                                                                                                                                                                                                                                                    | `true`                          |
| `sendRawDataExamples`                                    | Enable sending raw data examples from the third party API to port for testing and managing the integration mapping                                                                                                                                                                                                                                                                                                                                                                                 | `true`                          |
| `podAnnotations`                                         | Annotations to be added to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                            |
| `podServiceAccount.name`                                 | Service account to attach to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `null`                          |
| `podSecurityContext`                                     | Security context applied to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `{}`                            |
| `containerSecurityContext`                               | Security context applied to the container.                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                            |
| `extraInitContainers`                                    | Additional init containers to be added to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                            |
| `workload.kind`                                          | Kind of the workload. Can be either Deployment or CronJob                                                                                                                                                                                                                                                                                                                                                                                                                                          | `Deployment`                    |
| `workload.deployment.replicas`                           | Number of deployment replicas (currently only supports 0 or 1).                                                                                                                                                                                                                                                                                                                                                                                                                                    | `1`                             |
| `workload.deployment.rolloutStrategy`                    | Deployment rollout strategy.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `Recreate`                      |
| `workload.cron.resyncTimeoutMinutes`                     | Timeout in minutes for the resync cron job. When set to 0 or null, the cron job will not have a timeout.                                                                                                                                                                                                                                                                                                                                                                                           | `60`                            |
| `workload.cron.resyncOnInstall`                          | Should the first installation trigger a resync job.                                                                                                                                                                                                                                                                                                                                                                                                                                                | `true`                          |
| `workload.cron.resyncOnUpgrade`                          | Should the upgrade trigger a resync job.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `true`                          |
| `workload.cron.suspend`                                  | Should the cron scheduling be enabled                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `true`                          |
| `workload.cron.failedJobsHistoryLimit`                   | Number of failed CronJob executions to keep.                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `1`                             |
| `workload.cron.successfulJobsHistoryLimit`               | Number of successful CronJob executions to keep.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `1`                             |
| `workload.cron.initContainer.serviceAccount.name`        | Custom service account name for CronJob init container. If empty, auto-generates from integration.type and integration.identifier                                                                                                                                                                                                                                                                                                                                                                  | `""`                            |
| `workload.cron.kubectlImage`                             | Kubectl image used in CronJob init container.                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `bitnamisecure/kubectl:latest`  |
| `terminationGracePeriodSeconds`                          | Grace period for pod termination.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `30`                            |
| `clientTimeout`                                          | Client timeout for API requests (in seconds).                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `null`                          |
| `resources`                                              | Container resource requests and limits.                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{}`                            |
| `nodeSelector`                                           | NodeSelector applied to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                            |
| `tolerations`                                            | Tolerations applied to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `[]`                            |
| `affinity`                                               | Affinity applied to the pod.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                            |
| `imageRegistry`                                          | Image registry override.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `ghcr.io/port-labs`             |
| `image`                                                  | Custom container image name (without registry, but including tag). If not specified, defaults to `port-ocean-{integration.type}:{integration.version}`.                                                                                                                                                                                                                                                                                                                                            | `""`                            |
| `imagePullPolicy`                                        | Image pull policy for the container.                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `Always`                        |
| `imagePullSecrets`                                       | Image pull secrets                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                            |
| `secret.name`                                            | Secret object name. Can also be a list of strings when useExistingSecret is set to true, allowing the deployment to pull multiple secrets into the environment variables                                                                                                                                                                                                                                                                                                                           | `""`                            |
| `secret.create`                                          | Enable this if you wish the chart to create a secret with the sensitive configurations.                                                                                                                                                                                                                                                                                                                                                                                                            | `true`                          |
| `secret.useExistingSecret`                               | Enable this if you wish to create your own secret with credentials.<br>You must provide the following secrets:<br>`OCEAN__PORT__CLIENT_ID`<br>`OCEAN__PORT__CLIENT_SECRET`<br>Moreover, you need to provide sensitive configurations (required ones are **MUST**) for the selected integration:<br>Secret key format:`OCEAN__INTEGRATION__CONFIG__{{ $configName \| snakecase \| upper }}`<br>Example (if config name is `clusterConfMapping`): `OCEAN__INTEGRATION__CONFIG__CLUSTER_CONF_MAPPING` | `false`                         |
| `service.enabled`                                        | Specifies whether the service is enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `true`                          |
| `service.type`                                           | Service type for the Port application.                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `ClusterIP`                     |
| `service.port`                                           | Port number for the service.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `8000`                          |
| `service.portName`                                       | Name assigned to the port exposed by the Service. Defaults to `ocean-port`.                                                                                                                                                                                                                                                                                                                                                                                                                        | `ocean-port`                    |
| `service.annotations`                                    | Annotations for the service object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                            |
| `ingress.enabled`                                        | Specifies whether the ingress is enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `false`                         |
| `ingress.className`                                      | Specifies the ingress ClassName.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                            |
| `ingress.annotations`                                    | Annotations for the ingress object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                            |
| `ingress.host`                                           | Hostname for the ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `null`                          |
| `ingress.path`                                           | Path for the ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `/`                             |
| `ingress.pathType`                                       | Path type for the ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `Prefix`                        |
| `ingress.tls`                                            | TLS configuration for the ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                            |
| `integration.identifier`                                 | Identifier for the integration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `""`                            |
| `integration.version`                                    | Version of the integration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `""`                            |
| `integration.type`                                       | Type of the integration. i.e (`pagerduty`)                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `""`                            |
| `integration.config`                                     | Configuration for the integration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `{}`                            |
| `integration.secrets`                                    | Secrets for the integration (irrelevant if secret.create=false).                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                            |
| `integration.extraConfig`                                | Additional configuration for the integration.                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `{}`                            |
| `integration.oauth.enabled`                              | Enable OAuth support for the integration.                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `false`                         |
| `integration.oauth.access_token_file_path`               | Path to OAuth access token file in the container.                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `/app/.config/oauth_token`      |
| `integration.eventListener.type`                         | Event listener type: WEBHOOK, KAFKA, or SAMPLE                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `KAFKA`                         |
| `integration.eventListener.brokers`                      | Kafka brokers for event listening.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | (configured brokers)            |
| `integration.processExecution.mode`                      | Process execution mode. Can be either `single_process` or `multi_process`                                                                                                                                                                                                                                                                                                                                                                                                                          | `multi_process`                 |
| `integration.processExecution.prometheusMultiProcessDir` | Directory for Prometheus multi-process mode metrics.                                                                                                                                                                                                                                                                                                                                                                                                                                               | `/tmp/ocean/prometheus/metrics` |
| `selfSignedCertificate`                                  | Self Signed certificate for the integration                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `{}`                            |
| `selfSignedCertificate.enabled`                          | Enable self-signed certificate trust for the integration.                                                                                                                                                                                                                                                                                                                                                                                                                                          | `false`                         |
| `selfSignedCertificate.certificate`                      | The value of the self-signed certificate (only when `selfSignedCertificate.enabled=true`)                                                                                                                                                                                                                                                                                                                                                                                                          | `""`                            |
| `selfSignedCertificate.secret`                           | Secret with self-signed certificate                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                            |
| `selfSignedCertificate.secret.useExistingSecret`         | Enable this if you wish to use your own secret with the self-signed certificate                                                                                                                                                                                                                                                                                                                                                                                                                    | `false`                         |
| `selfSignedCertificate.secret.key`                       | The key in the existing self-signed certificate secret                                                                                                                                                                                                                                                                                                                                                                                                                                             | `crt`                           |
| `selfSignedCertificate.secret.name`                      | The name of an existing secret containing the self-signed certificate                                                                                                                                                                                                                                                                                                                                                                                                                              | `""`                            |
| `eventListener.type`                                     | Type of the event listener for the integration, one of the following "WEBHOOK" / "KAFKA" / "SAMPLE"                                                                                                                                                                                                                                                                                                                                                                                                | `"KAFKA"`                       |
| `liveEvents.baseUrl`                                     | The base url of the live events worker required to setup and receive webhook HTTP requests                                                                                                                                                                                                                                                                                                                                                                                                         | `""`                            |
| `liveEvents.worker.enabled`                              | Enable stand-alone live events worker deployment                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `false`                         |
| `liveEvents.worker.initializePortResources`              | Whether live events worker should initialize Port resources                                                                                                                                                                                                                                                                                                                                                                                                                                        | `false`                         |
| `liveEvents.worker.replicaCount`                         | Number of stand-alone live events worker replicas                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `1`                             |
| `liveEvents.worker.resources`                            | Container resource requests and limits for stand-alone live events worker                                                                                                                                                                                                                                                                                                                                                                                                                          | `{}`                            |
| `liveEvents.deployment.rolloutStrategy`                  | Standalone live events worker deployment rollout strategy (type and rolling update settings).                                                                                                                                                                                                                                                                                                                                                                                                      | `RollingUpdate`                 |
| `liveEvents.deployment.revisionHistoryLimit`             | Number of revisions to keep for live events worker deployment.                                                                                                                                                                                                                                                                                                                                                                                                                                     | `1`                             |
| `liveEvents.service.enabled`                             | Specifies whether the live events service is enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                       | `true`                          |
| `liveEvents.service.type`                                | Service type for the live events worker.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `ClusterIP`                     |
| `liveEvents.service.port`                                | Port number for the live events service.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `8000`                          |
| `liveEvents.service.portName`                            | Name of the port exposed by the Service created for the Live Events worker. Defaults to `ocean-port`.                                                                                                                                                                                                                                                                                                                                                                                              | `ocean-port`                    |
| `liveEvents.service.annotations`                         | Annotations for the live events service.                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                            |
| `liveEvents.ingress.enabled`                             | Specifies whether the live events ingress is enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                       | `false`                         |
| `liveEvents.ingress.className`                           | Specifies the live events ingress ClassName.                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                            |
| `liveEvents.ingress.annotations`                         | Annotations for the live events ingress object.                                                                                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                            |
| `liveEvents.ingress.host`                                | Hostname for the live events ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                              | `null`                          |
| `liveEvents.ingress.path`                                | Path for the live events ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `/`                             |
| `liveEvents.ingress.pathType`                            | Path type for the live events ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `Prefix`                        |
| `liveEvents.ingress.tls`                                 | TLS configuration for the live events ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `[]`                            |
| `liveEvents.extraLabels`                                 | Extra labels to be applied to live events resources.                                                                                                                                                                                                                                                                                                                                                                                                                                               | `{}`                            |
| `liveEvents.extraConfig`                                 | Additional configuration for live events worker.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                            |
| `livenessProbe.enabled`                                  | Enable liveness probe for the main container.                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `true`                          |
| `readinessProbe.enabled`                                 | Enable readiness probe for the main container.                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `true`                          |
| `postgresql.enabled`                                     | Enable PostgreSQL database                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                         |
| `postgresql.image.registry`                              | PostgreSQL image registry                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `docker.io`                     |
| `postgresql.image.repository`                            | PostgreSQL image repository                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `bitnamisecure/postgresql`      |
| `postgresql.image.tag`                                   | PostgreSQL image tag                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `latest`                        |
| `postgresql.global.postgresql.auth.database`             | PostgreSQL database name                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `ocean`                         |
| `postgresql.global.postgresql.auth.username`             | PostgreSQL username                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `port_admin`                    |
| `postgresql.global.postgresql.auth.password`             | PostgreSQL password                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `password`                      |
| `postgresql.global.postgresql.auth.postgresPassword`     | PostgreSQL postgres user password                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `password`                      |
| `lakehouseEnabled`                                       | Enable lakehouse features                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | `true`                          |
| `streamingEnabled`                                       | Process large HTTP responses via disk-buffered chunks instead of loading entire response into memory, preventing OOM on multi-GB payloads.                                                                                                                                                                                                                                                                                                                                                         | `false`                         |
| `actionsProcessor.enabled`                               | Enable actions processor workload                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                         |
| `actionsProcessor.worker.enabled`                        | Enable stand-alone actions processor worker deployment                                                                                                                                                                                                                                                                                                                                                                                                                                             | `false`                         |
| `actionsProcessor.worker.rolloutStrategy`                | Actions processor worker deployment rollout strategy.                                                                                                                                                                                                                                                                                                                                                                                                                                              | `Recreate`                      |
| `actionsProcessor.worker.revisionHistoryLimit`           | Number of revisions to keep for actions processor deployment.                                                                                                                                                                                                                                                                                                                                                                                                                                      | `1`                             |
| `actionsProcessor.worker.replicaCount`                   | Number of actions processor worker replicas                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `1`                             |
| `actionsProcessor.worker.initializePortResources`        | Whether actions processor worker should initialize Port resources                                                                                                                                                                                                                                                                                                                                                                                                                                  | `false`                         |
| `actionsProcessor.worker.resources`                      | Container resource requests and limits for actions processor worker                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                            |
| `actionsProcessor.service.enabled`                       | Specifies whether the actions processor service is enabled or not.                                                                                                                                                                                                                                                                                                                                                                                                                                 | `true`                          |
| `actionsProcessor.service.type`                          | Service type for the actions processor worker.                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `ClusterIP`                     |
| `actionsProcessor.service.port`                          | Port number for the actions processor service.                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `8000`                          |
| `actionsProcessor.service.portName`                      | Name of the port exposed by the Service created for the Actions Processor worker.                                                                                                                                                                                                                                                                                                                                                                                                                  | `ocean-port`                    |
| `actionsProcessor.service.annotations`                   | Annotations for the actions processor service.                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                            |
| `actionsProcessor.extraConfig`                           | Additional configuration for actions processor worker.                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                            |

When PostgreSQL is enabled, all workloads (Deployment, CronJob, and Live Events) will wait for PostgreSQL to be ready before starting their main containers. This is done using an init container that checks PostgreSQL availability using `pg_isready`. The init container will retry every 2 seconds until PostgreSQL is available.

## Process Execution Modes

The chart supports two process execution modes:

1. `single_process` - Runs the integration in a single process. This is the default mode and is suitable for most use cases.
2. `multi_process` - Runs the integration in multiple processes, which can be useful for handling high concurrency or when you need to scale horizontally.

To configure the process execution mode, set the following in your values:

```yaml
integration:
  processExecution:
    mode: "multi_process" # or "single_process"
    prometheusMultiProcessDir: "/custom/path" # Optional: Directory for Prometheus metrics in multi-process mode
```

**Note**: When using `multi_process` mode:

- If `prometheusMultiProcessDir` is not provided, it will default to `/tmp/ocean/prometheus/metrics`
- The directory must be writable by the container and have sufficient space for metrics storage

To override values in `helm install`, use either the `--set` flag.

Alternatively, you can use a YAML file that specifies the values while installing the chart. For example:

    helm install my-ocean-integration port-labs/port-ocean \
       --create-namespace --namespace port-ocean \
       -f custom_values.yaml

### Self-signed certificate trust

For self-hosted 3rd-party applications with self-signed certificates, you will need to add your CA to the integration's configuration.
To do so, you will need to run the `helm install` command with the following flags:

```sh
helm install my-ocean-integration port-labs/port-ocean \
   --create-namespace --namespace port-ocean \
   -f custom_values.yaml \
   # Flag for enabling self signed certificates
   --set selfSignedCertificate.enabled=true \
   # Flag for passing the certificate file
   --set-file selfSignedCertificate.certificate=/PATH/TO/CERTIFICATE.crt
```

## PostgreSQL Configuration

The chart supports an optional PostgreSQL database deployment. When enabled, PostgreSQL will be deployed as a dependency of the Port Ocean integration. The database is configured with the following default settings:

- Database name: `ocean`
- Username: `port_admin`
- Password: `password` (should be changed in production)

To enable PostgreSQL, set the following in your values:

```yaml
postgresql:
  enabled: true
  global:
    postgresql:
      auth:
        database: ocean
        password: your-secure-password
        postgresPassword: your-secure-postgres-password
        username: port_admin
```

**Note**: It's recommended to use a secure password in production environments and consider using Kubernetes secrets to manage sensitive credentials.
